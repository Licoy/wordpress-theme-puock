"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ownKeys(e,t){var a,n=Object.keys(e);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(e),t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)),n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _createForOfIteratorHelper(t,e){var a,n,o,i,r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return n=!(a=!0),{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){n=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(n)throw o}}};if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return r&&(t=r),i=0,{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var a;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(a="Object"===(a=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:a)||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,a){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0===a)return("string"===e?String:Number)(t);a=a.call(t,e||"default");if("object"!==_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}var puockGlobalData={loads:{}},TYPE_PRIMARY="primary",TYPE_WARNING="warning",TYPE_DANGER="danger",TYPE_SUCCESS="success",TYPE_INFO="info",Puock=function(){function e(){var t=this;_classCallCheck(this,e),_defineProperty(this,"data",{tag:"puock",params:{home:null,use_post_menu:!1,is_single:!1,is_pjax:!1,vd_comment:!1,vd_gt_id:null,vd_type:null,main_lazy_img:!1,link_blank_open:!1,async_view_id:null,mode_switch:!1,async_view_generate_time:null,off_img_viewer:!1,off_code_highlighting:!1},comment:{loading:!1,time:5,val:null,replyId:null},instance:{},modalStorage:{}}),_defineProperty(this,"gt",{validate:function(){t.data.instance.gt_callback=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t.data.instance.gt.showCaptcha()}})}return _createClass(e,[{key:"onceInit",value:function(){var a=this;this.pageInit(),$(document).on("click",".fancybox",function(){return!1}),$(document).on("click","#rb-float-actions>div",function(t){var t=$(a.ct(t)),e=t.data("to");e?(e="top"===e?0:window.document.body.clientHeight,$("html,body").stop().animate({scrollTop:e},50)):(e=t.data("to-area"))&&a.gotoArea(e)}),$(document).on("click",".colorMode",function(){a.modeChange(null,!0)}),$(document).on("click",".captcha",function(t){a.loadCommentCaptchaImage($(a.ct(t)))}),this.data.params.is_pjax&&this.instanceClickLoad(),this.initBasicDOMEvent(),this.sidebarMenuEventInit(),this.searchInit(),this.eventShareStart(),this.modeInit(),this.registerMobileMenu(),this.registerModeChangeEvent(),this.eventCommentPageChangeEvent(),this.eventCommentPreSubmit(),this.eventSmiley(),this.eventOpenCommentBox(),this.eventCloseCommentBox(),this.eventSendPostLike(),this.eventPostMainBoxResize(),this.swiperOnceEvent(),this.initModalToggle(),layer.config({shade:.5}),console.log("\n %c Puock Theme %c https://github.com/Licoy/wordpress-theme-puock \n\n","color:#f1ab0e;background:#030307;padding:5px 0;border-top-left-radius:8px;border-bottom-left-radius:8px","background:#aa80ff;padding:5px 0;border-top-right-radius:8px;border-bottom-right-radius:8px")}},{key:"pageInit",value:function(){this.loadParams(),this.pageChangeInit(),this.data.params.is_single&&this.data.params.use_post_menu&&this.generatePostMenuHTML()}},{key:"instanceClickLoad",value:function(){var e=this;InstantClick.init("mousedown"),InstantClick.go=function(t){var e=document.createElement("a");e.href=t,document.body.appendChild(e),e.click()},InstantClick.on("change",function(t){e.loadParams(),e.pageChangeInit()}),this.loadCommentInfo()}},{key:"ct",value:function(t){return t.currentTarget}},{key:"initBasicDOMEvent",value:function(){var c=this;$(document).on("click",".toggle-el-show-hide",function(t){var t=$(c.ct(t)),e=$(t.attr("data-target")),a=$(t.attr("data-self")),n=t.attr("data-modal-title");e.hasClass("d-none")?(a.addClass("d-none"),e.removeClass("d-none")):(a.removeClass("d-none"),e.addClass("d-none")),n&&t.closest(".modal").find(".modal-title").text(n)}),$(document).on("submit",".ajax-form",function(t){t.preventDefault();var r=$(c.ct(t)),e=r.find(":input");if(0===e.length)c.toast("表单元素为空",TYPE_DANGER);else{for(var a=0;a<e.length;a++){var n=$(e[a]);if(void 0!==n.attr("data-required")&&""===n.val())return c.toast(n.attr("data-tip")||n.attr("placeholder"),TYPE_WARNING),!1}var t=r.data("validate"),o=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=r.attr("action"),a=r.attr("method"),t=c.parseFormData(r,t),n=r.attr("data-success"),o=r.attr("data-error"),i=c.startLoading();$.ajax({url:e,method:a,data:t,dataType:"json",success:function(t){var e;c.stopLoading(i),0===t.code||t.success?(c.toast(t.msg||n,TYPE_SUCCESS),void 0===r.data("no-reset")&&r.trigger("reset"),t.data&&(e=t.data).action&&setTimeout(function(){"reload"===e.action&&c.goUrl(window.location.href)},500)):(c.toast(t.msg||t.data||o,TYPE_DANGER),c.loadCommentCaptchaImage(r,!0))},error:function(t){c.stopLoading(i),c.toast("请求错误：".concat(t.statusText),TYPE_DANGER),c.loadCommentCaptchaImage(r,!0)}})};"gt"===t?c.gt.validate(function(t){o(t)}):o()}return!1})}},{key:"pageLinkBlankOpenInit",value:function(){this.data.params.link_blank_open&&$(".entry-content").find("a").each(function(t,e){$(e).attr("target","blank")})}},{key:"loadCommentCaptchaImage",value:function(t){var e,a=this;1<arguments.length&&void 0!==arguments[1]&&arguments[1]?t.find(".captcha").each(function(t,e){a.loadCommentCaptchaImage($(e))}):(e=t.attr("src")+"&t="+(new Date).getTime(),t.attr("src",e))}},{key:"searchInit",value:function(){function t(){var t=$("#search"),e="true"===t.attr("data-open"),a=e?"Out":"In";t.attr("class","animated fade"+a+"Left"),$("#search-backdrop").attr("class","modal-backdrop animated fade"+a+"Right"),t.attr("data-open",!e),e||t.find("input").focus()}var e=this;$(document).on("click",".search-modal-btn",function(){t()}),$(document).on("click","#search-backdrop",function(){t()}),$(document).on("submit",".global-search-form",function(t){t.preventDefault();t=$(e.ct(t));e.goUrl(t.attr("action")+"/?"+t.serialize())})}},{key:"goUrl",value:function(t){this.data.params.is_pjax?InstantClick.go(t):window.location.href=t}},{key:"validateInit",value:function(){var e=this;"gt"===this.data.params.vd_type&&initGeetest4({captchaId:this.data.params.vd_gt_id,product:"bind"},function(t){(e.data.instance.gt=t).onSuccess(function(){var t=e.data.instance.gt.getValidate();e.data.instance.gt_callback&&e.data.instance.gt_callback(t)})})}},{key:"rippleInit",value:function(){var t={debug:!1,on:"mousedown",opacity:.4,color:"var(--pk-c-light)",multi:!1,duration:.6,rate:function(t){return t},easing:"linear"};jQuery.ripple(".btn",t),jQuery.ripple(".ww",t)}},{key:"eventShareStart",value:function(){var o=this;$(document).on("click",".share-to",function(t){t=$(o.ct(t)).attr("data-id");if("wx"!==t){var e=window.location.href,a=$("#post-title").text(),n=null;switch(t){case"wb":n="https://service.weibo.com/share/share.php?pic=&title="+a+"&url="+e+"&appkey=";break;case"qzone":n="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?title="+a+"&url="+e;break;case"tw":n="https://twitter.com/intent/tweet?url="+e;break;case"fb":n="https://www.facebook.com/sharer.php?u"+e}n&&window.open(n,"_blank")}})}},{key:"sidebarMenuEventInit",value:function(){var i=this,r=null;$(document).on("touchend",".post-menu-toggle",function(t){t.preventDefault(),i.toggleMenu()}),$(document).on("click",".post-menu-toggle",function(){i.toggleMenu()}),$(document).on("click",".post-menu-item",function(t){var t=$(i.ct(t)),e=t.attr("data-id");if(r)for(var a=t.parents("ul"),n="post-menu-sub-"+r;;){if(void 0===n)break;var o=$("."+n);if(void 0===o.attr("class")||a.attr("class")===o.attr("class"))break;o.hide(),n=o.parents("ul").attr("class")}t=$(".post-menu-sub-"+e);0<t.length&&(t.show(),r=e)}),$(document).on("click",".pk-menu-to",function(t){var t=$(i.ct(t)).attr("href"),e=$("#header").innerHeight();return $("html, body").stop().animate({scrollTop:$(t).offset().top-e-10+"px"},{duration:50,easing:"swing"}),!1})}},{key:"toggleMenu",value:function(){var t=$("#post-menu-state"),e="data-open",a=t.hasClass(e),n=$("#post-menu-content");a?(n.hide(),t.removeClass(e)):(n.show(),t.addClass(e))}},{key:"lazyLoadInit",value:function(){window.lozad&&lozad([1<arguments.length&&void 0!==arguments[1]?arguments[1]:".lazy",'img[data-lazy="true"]'],{rootMargin:"10px 0px",threshold:.1,enableAutoReload:!0,load:function(t){t.classList.add("loaded"),t.src=t.getAttribute("data-src")}}).observe()}},{key:"loadParams",value:function(){this.data.params=puock_metas,this.data.commentVd="on"===this.data.params.vd_comment}},{key:"initReadProgress",value:function(){var e=$("#page-read-progress .progress-bar");document.addEventListener("scroll",function(){var t=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100;e.attr("style","width:"+t.toFixed(0)+"%")})}},{key:"tooltipInit",value:function(){_toConsumableArray(0<arguments.length&&void 0!==arguments[0]?arguments[0]:$('[data-bs-toggle="tooltip"]')).map(function(t){new bootstrap.Tooltip(t,{placement:"bottom",trigger:"hover"})})}},{key:"pageChangeInit",value:function(){var e=this,t=(this.initReadProgress(),this.modeInit(),this.loadCommentInfo(),this.katexParse(),this.initCodeHighlight(),this.pageLinkBlankOpenInit(),this.initGithubCard(),this.keyUpHandle(),this.loadHitokoto(),this.asyncCacheViews(),this.swiperInit(),this.validateInit(),this.rippleInit(),this.data.params.use_post_menu&&this.generatePostMenuHTML(),this.tooltipInit(),this.data.params.off_img_viewer||jQuery(".entry-content").viewer({navbar:!1,url:this.data.params.main_lazy_img?"data-src":"src"}),new ClipboardJS(".pk-copy",{text:function(t){var t=$(t),e=t.attr("data-cp-input"),a=t.attr("data-cp-el"),n=t.attr("data-cp-val"),o=t.attr("data-cp-func");return void 0!==o?window[o](t):void 0!==n?n:void 0!==e?$(e).val():(void 0!==a?$(a):t).text()}}));t.on("success",function(t){t=$(t.trigger).attr("data-cp-title")||"";e.toast("复制".concat(t,"成功"))}),t.on("error",function(t){t=$(t.trigger).attr("data-cp-title")||"";e.toast("复制".concat(t,"失败"),TYPE_DANGER)}),this.lazyLoadInit(),$("#post-main, #sidebar").theiaStickySidebar({additionalMarginTop:20})}},{key:"getPostMenuStructure",value:function(){var t,e=[],a=_createForOfIteratorHelper($(".entry-content").find("h1,h2,h3,h4,h5,h6"));try{for(a.s();!(t=a.n()).done;){var n=t.value;e.push({name:$(n).text().trim(),level:n.tagName.toLowerCase(),id:$(n).attr("id")})}}catch(t){a.e(t)}finally{a.f()}return e}},{key:"generatePostMenuHTML",value:function(){var c=this.getPostMenuStructure();if(0<c.length){var e="<ul>";if(0<c.length){var l=[],s=6,d=function(t){return t.children=[],t},u=function(t){return t.levelInt=parseInt(t.level.replace("h","")),t.levelInt<s&&(s=t.levelInt),t.levelInt},t=d(c[0]),m=u(t),h=0,f=function t(e,a){var n=o(e,a);return null!=n&&u(n)===u(e)?t(n,a):n},o=function t(e,a){if(h>=c.length-1)return null;var n=++h,n=d(c[n]),o=u(e),i=u(n),r=null;if(i===m)l.push(n),r=t(n,null);else if(o<i)e.children.push(n),r=t(n,e);else{if(i!==o||null==a)return n;a.children.push(n),r=t(n,a)}return null!=r&&u(r)===o&&(a.children.push(r),r=f(r,a)),r};for(l.push(t);;){var a=o(t,null);if(null==a)break;o(a,null)}var p=0,n=function t(e,a){var n=++p,o=10*(e.levelInt-s),i='<li data-level="'.concat(e.levelInt,"\" style='padding-left:").concat(o,"px'>");if(i+="<a class='pk-menu-to a-link t-w-400 t-md post-menu-item' data-parent=\"".concat(a,'" data-id="').concat(n,"\" href='#").concat(e.id,"'><i class='fa ").concat(0<e.children.length?"fa-angle-right":"fa-file-invoice"," t-sm c-sub mr-1'></i> ").concat(e.name,"</a>"),0<e.children.length){i+='<ul class="post-menu-sub-'.concat(n,'" data-parent="').concat(a+1,'">');var r,c=_createForOfIteratorHelper(e.children);try{for(c.s();!(r=c.n()).done;)i+=t(r.value,n)}catch(t){c.e(t)}finally{c.f()}i+="</ul>"}return i+="</li>"};l.forEach(function(t){e+=n(t,p)})}e+="</ul>",$("#post-menu-content-items").html(e),$(".post-menus-box").show()}}},{key:"initCodeHighlight",value:function(){var e=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"body";this.data.params.off_code_highlighting||void 0!==window.hljs&&(window.hljs.configure({ignoreUnescapedHTML:!0}),$(a).find("pre").each(function(t,e){var a=$(e),n=a.children("code")?a.children("code").attr("class"):void 0;n&&(-1!==n.indexOf("katex")||-1!==n.indexOf("latex")||-1!==n.indexOf("flowchart")||-1!==n.indexOf("flow")||-1!==n.indexOf("seq")||-1!==n.indexOf("math"))||a.attr("id")||(a.attr("id","hljs-item-"+t),a.before("<div class='pk-code-tools' data-pre-id='hljs-item-"+t+"'><div class='dot'><i></i><i></i><i></i></div><div class='actions'><div><i class='i fa fa-copy cp-code' data-clipboard-target='#hljs-item-"+t+"'></i></div></div></div>"),window.hljs.highlightBlock(e),window.hljs.lineNumbersBlock(e))}),t)&&new ClipboardJS(".cp-code").on("success",function(t){t.clearSelection(),e.toast("已复制到剪切板")})}},{key:"localstorageToggle",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return null!=e?localStorage.setItem(t,e):localStorage.getItem(t)}},{key:"loadCommentInfo",value:function(){var t=this.localstorageToggle("comment_author"),e=this.localstorageToggle("comment_email"),a=this.localstorageToggle("comment_url");null!=t&&null!=e&&($("#comment_author").val(t),$("#comment_email").val(e),$("#comment_url").val(a))}},{key:"setCommentInfo",value:function(){this.localstorageToggle("comment_author",$("#comment_author").val()),this.localstorageToggle("comment_email",$("#comment_email").val()),this.localstorageToggle("comment_url",$("#comment_url").val())}},{key:"asyncCacheViews",value:function(){this.data.params.async_view_id&&this.data.params.async_view_generate_time&&10<(new Date).getTime()/1e3-this.data.params.async_view_generate_time&&$.post(this.data.params.home+"/wp-admin/admin-ajax.php?action=async_pk_views",{id:this.data.params.async_view_id},function(t){0!==t.code?console.error(t.msg):$("#post-views").text(t.data)},"json").fail(function(t){console.error(t)})}},{key:"modeInit",value:function(){this.modeChange()}},{key:"modeChange",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=$("body"),n=("string"==typeof t&&(t="true"===t),Cookies.get("mode")||"auto"),e=(null===t&&(t="light"===n,"auto"===n)&&(t=!window.matchMedia("(prefers-color-scheme:dark)").matches),e&&(t="light"===n?!(n="dark"):"dark"===n?(n="auto",!window.matchMedia("(prefers-color-scheme:dark)").matches):(n="light",!0),console.log(n,t)),"d-none");(t?($("#logo-light").removeClass(e),$("#logo-dark")):($("#logo-dark").removeClass(e),$("#logo-light"))).addClass(e),$(".colorMode").each(function(t,e){e=$(e),e="i"===e.prop("localName")?e:$(e).find("i");e&&e.removeClass("fa-sun").removeClass("fa-moon").removeClass("fa-circle-half-stroke").addClass("auto"===n?"fa-circle-half-stroke":"light"===n?"fa-sun":"fa-moon")}),a.removeClass(this.data.tag+"-auto"),a.removeClass(t?this.data.tag+"-dark":this.data.tag+"-light"),a.addClass(t?this.data.tag+"-light":this.data.tag+"-dark"),Cookies.set("mode",n)}},{key:"modeChangeListener",value:function(){"auto"===Cookies.get("mode")&&this.modeChange(!window.matchMedia("(prefers-color-scheme:dark)").matches)}},{key:"registerModeChangeEvent",value:function(){var e=this;if(this.data.params.mode_switch)try{window.matchMedia("(prefers-color-scheme:dark)").addEventListener("change",function(){e.modeChangeListener()})}catch(t){window.matchMedia("(prefers-color-scheme:dark)").addListener(function(){e.modeChangeListener()})}}},{key:"infoToastShow",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"提示",a=$("#infoToast");$("#infoToastTitle").html(e),$("#infoToastText").html(t),a.modal("show")}},{key:"registerMobileMenu",value:function(){function t(t){"string"!=typeof t&&(t="Out"),$("#mobile-menu").attr("class","animated fade"+t+"Left"),$("#mobile-menu-backdrop").attr("class","modal-backdrop animated fade"+t+"Right")}$(document).on("click","#mobile-menu-backdrop",t),$(document).on("click",".mobile-menu-close",t),$(document).on("click",".mobile-menu-s",function(){t("In")})}},{key:"gotoArea",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:50,t=$(t).offset().top-$("#header").height()-10;$("html,body").stop().animate({scrollTop:t},e)}},{key:"pushAjaxCommentHistoryState",value:function(t){history.pushState({foo:"bar"},"page 2",t)}},{key:"eventCommentPageChangeEvent",value:function(){var o=this;$(document).on("click",".comment-ajax-load a.page-numbers",function(t){var e=$("#post-comments"),a=$("#comment-ajax-load"),n=($("#comment-cancel").click(),$(o.ct(t)).attr("href"));return o.pushAjaxCommentHistoryState(n),e.html(" "),o.gotoArea("#comments"),a.removeClass("d-none"),$.post(n,{},function(t){e.html($(t).find("#post-comments")),a.addClass("d-none"),o.initCodeHighlight(!1),o.lazyLoadInit(e)}).fail(function(){location=n}),!1})}},{key:"parseFormData",value:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=t.serializeArray(),n=_objectSpread({},e),o=0;o<a.length;o++)n[a[o].name]=a[o].value;return jQuery.param(n)}},{key:"eventCommentPreSubmit",value:function(){var a=this;$(document).on("submit","#comment-form",function(e){if(e.preventDefault(),"0"!==$("#comment-logged").val()||""!==$.trim($("#comment_author").val())&&""!==$.trim($("#comment_email").val()))if(""===$.trim($("#comment").val()))a.toast("评论内容不能为空",TYPE_WARNING);else{if(a.data.params.vd_comment){if("img"!==a.data.params.vd_type)return void a.gt.validate(function(t){a.commentSubmit(a.ct(e),t)});if(""===$.trim($("#comment-vd").val()))return void a.toast("验证码不能为空",TYPE_WARNING)}a.commentSubmit(a.ct(e))}else a.toast("评论信息不能为空",TYPE_WARNING)})}},{key:"commentSubmit",value:function(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=$("#comment-form").attr("action"),t=(this.commentFormLoadStateChange(),$(t));$.ajax({url:a,data:this.parseFormData(t,e),type:t.attr("method"),success:function(t){var e,a;n.toast("评论已提交成功",TYPE_SUCCESS),n.loadCommentCaptchaImage($(".comment-captcha")),$("#comment-vd").val(""),$("#comment").val(""),(null!=n.data.comment.replyId?(0===(a=(e=$("#comment-"+n.data.comment.replyId)).find(".children")).length&&(e.append("<ul class='children'></ul>"),a=e.find(".children")),a):$("#post-comments")).prepend(t),$("#comment-cancel").click(),n.commentFormLoadStateChange(),n.setCommentInfo()},error:function(t){var e=null;try{e=JSON.parse(t.responseText)}catch(t){}n.commentFormLoadStateChange(),e?(n.toast(e.msg,TYPE_DANGER),e.refresh_code&&n.loadCommentCaptchaImage($(".comment-captcha"))):n.toast(t.responseText,TYPE_DANGER)}})}},{key:"commentFormLoadStateChange",value:function(){var t=this,e=$("#comment-submit");this.data.comment.loading?(e.html("请等待"+this.data.comment.time+"s"),this.data.comment.val=setInterval(function(){t.data.comment.time<=1?(clearInterval(t.data.comment.val),e.html("提交评论"),e.removeAttr("disabled"),t.data.comment.time=5):(--t.data.comment.time,e.html("请等待"+t.data.comment.time+"s"))},1e3)):(e.html('<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>提交中...'),e.attr("disabled",!0)),this.data.comment.loading=!this.data.comment.loading}},{key:"eventOpenCommentBox",value:function(){var a=this;$(document).on("click","[id^=comment-reply-]",function(t){var e;a.data.comment.replyId=$(a.ct(t)).attr("data-id"),""===$.trim(a.data.comment.replyId)?a.toast("结构有误",TYPE_DANGER):(t=$("#comment-form"),e=$("#comment-box-"+a.data.comment.replyId),t.addClass("box-sw"),e.removeClass("d-none").append(t),$("#comment-cancel").removeClass("d-none"),$("#comment").val(""),$("#comment_parent").val(a.data.comment.replyId))})}},{key:"eventCloseCommentBox",value:function(){var a=this;$(document).on("click","#comment-cancel",function(){var t=$("#comment-form"),e=$("#comment-box-"+a.data.comment.replyId);t.removeClass("box-sw"),e.addClass("d-none"),$("#comment-form-box").append(t),$("#comment-cancel").addClass("d-none"),a.data.comment.replyId=null})}},{key:"eventSendPostLike",value:function(){var n=this,o=0;$(document).on("click","#post-like",function(t){var e,a=(new Date).getTime();a-o<3e3?n.toast("操作过于频繁",TYPE_WARNING):(o=a,a=(e=$(n.ct(t))).attr("data-id"),$.post("/wp-admin/admin-ajax.php",{action:"puock_like",um_id:a,um_action:"like"},function(t){0===t.e?(e.find("span").html(t.d),e.addClass("bg-primary text-light")):n.toast(t.t)},"json").fail(function(){n.toast("点赞异常",TYPE_DANGER)}))})}},{key:"eventSmiley",value:function(){var a=this;$(document).on("click",".smiley-img",function(t){var e=$("#comment");e.val(e.val()+" "+$(a.ct(t)).attr("data-id")+" "),layer.closeAll()})}},{key:"startLoading",value:function(){return layer.load(0,{shade:[.5,"#000"]})}},{key:"stopLoading",value:function(){layer.close(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)}},{key:"getRemoteHtmlNode",value:function(t,e){var a=this,n=this.startLoading();$.ajax({url:t,type:"GET",success:function(t){a.stopLoading(n),e(t)},error:function(t){console.error(t),a.stopLoading(n),a.toast("获取内容节点数据失败",TYPE_DANGER)}})}},{key:"initModalToggle",value:function(){var c=this;$(document).on("click",".pk-modal-toggle",function(t){var t=$(c.ct(t)),e=void 0!==t.data("no-title"),a=void 0!==t.data("no-padding"),n=t.attr("title")||t.data("title")||"提示",o=t.data("url"),i=t.data("once-load"),r=SparkMD5.hash(o);i&&c.data.modalStorage[r]?c.modalLoadRender(r,c.data.modalStorage[r],n,e,a):c.getRemoteHtmlNode(o,function(t){i&&!c.data.modalStorage[r]&&(c.data.modalStorage[r]=t),c.modalLoadRender(r,t,n,e,a)})})}},{key:"modalLoadRender",value:function(t,e,a,n,o){t="pk-modal-"+t,layer.open({type:1,title:!n&&a,content:'<div id="'.concat(t,"\" style='").concat(o?"":"padding: 20px","' class='fs14'>").concat(e,"</div>"),shadeClose:!0}),n=$("#"+t);this.lazyLoadInit(n),this.tooltipInit(n.find('[data-bs-toggle="tooltip"]'))}},{key:"eventPostMainBoxResize",value:function(){$(document).on("click",".post-main-size",function(){var t=$("#post-main"),e=$("#sidebar"),a=t.hasClass("col-lg-8");t.removeClass(a?"col-lg-8":"col-lg-12"),t.addClass(a?"col-lg-12":"col-lg-8"),a?e.removeClass("d-lg-block"):e.addClass("d-lg-block")})}},{key:"katexParse",value:function(){}},{key:"katexItemParse",value:function(e){var t=e.text(),a=e.get(0);if(0===e.parent("code").length)try{katex.render(t,a)}catch(t){e.html("<span class='err'>"+t)}}},{key:"initGithubCard",value:function(){$.each($(".github-card"),function(t,e){var a=$(e),n=a.attr("data-repo");n&&$.get("https://api.github.com/repos/".concat(n),function(t){var e='class="hide-hover" href="'.concat(t.html_url,'" target="_blank" rel="noreferrer"');a.html('<div class="card-header"><i class="fa-brands fa-github"></i><a '.concat(e,">").concat(t.full_name,'</a></div>\n                    <div class="card-body">').concat(t.description,'</div>\n                    <div class="card-footer">\n                    <div class="row">\n                    <div class="col-4"><i class="fa-regular fa-star"></i><a ').concat(e,">").concat(t.stargazers_count,'</a></div>\n                    <div class="col-4"><i class="fa-solid fa-code-fork"></i><a ').concat(e,">").concat(t.forks,'</a></div>\n                    <div class="col-4"><i class="fa-regular fa-eye"></i><a ').concat(e,">").concat(t.subscribers_count,"</a></div>\n                    </div>\n                    </div>\n                ")),a.addClass("loaded")},"json").fail(function(t){a.html('<div class="alert alert-danger"><i class="fa fa-warning"></i>&nbsp;请求Github项目详情异常：'.concat(n,"</div>"))})})}},{key:"keyUpHandle",value:function(){var n=$(".single-next-or-pre");n&&(window.onkeyup=function(t){var e;if("BODY"===(null==(e=t.target)?void 0:e.tagName)){var a=null;switch(t.key){case"ArrowLeft":a=n.find("a[rel='prev']").attr("href");break;case"ArrowRight":a=n.find("a[rel='next']").attr("href")}a&&(window.location=a)}})}},{key:"swiperInit",value:function(){$("[data-swiper='init']").each(function(t,e){var e=$(e),a=e.attr("data-swiper-class"),e=e.attr("data-swiper-args"),n={};e&&(n=JSON.parse(e)),new Swiper("."+a,n)})}},{key:"swiperOnceEvent",value:function(){var e=this;$(document).on("click",".swiper-slide a",function(t){e.data.params.is_pjax&&(t.preventDefault(),e.goUrl(t.currentTarget.href))})}},{key:"loadHitokoto",value:function(){setTimeout(function(){$(".widget-puock-hitokoto").each(function(t,e){var a=$(e),e=a.attr("data-api")||"https://v1.hitokoto.cn/";$.get(e,function(t){var e;a.find(".t").text(null!=(e=null!=(e=t.hitokoto)?e:t.content)?e:"无内容"),a.find(".f").text(t.from),a.find(".fb").removeClass("d-none")},"json").fail(function(t){console.error(t),a.find(".t").text("加载失败："+t.responseText||t),a.remove(".fb")})})},300)}},{key:"toast",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:TYPE_PRIMARY,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=Object.assign({duration:2600,close:!1,position:"right",gravity:"bottom",offset:{},className:"t-"+e},a),e=Toastify(_objectSpread({text:t},a));return e.showToast(),e}}]),e}();jQuery(function(){void 0===window.$&&(window.$=jQuery),window.Puock=new Puock,window.Puock.onceInit()});